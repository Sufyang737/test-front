{
  "name": "details_conversation",
  "type": "base",
  "schema": [
    {
      "name": "conversation_id",
      "type": "relation",
      "required": true,
      "options": {
        "collectionId": "conversation",
        "cascadeDelete": true
      }
    },
    {
      "name": "client_id",
      "type": "relation",
      "required": true,
      "options": {
        "collectionId": "clients",
        "cascadeDelete": false
      }
    },
    {
      "name": "lead_id",
      "type": "text",
      "required": false
    },
    {
      "name": "priority",
      "type": "select",
      "options": {
        "values": ["low", "medium", "high", "urgent"]
      },
      "required": true
    },
    {
      "name": "customer_source",
      "type": "select",
      "options": {
        "values": ["whatsapp", "website", "referral", "social_media", "other"]
      },
      "required": true
    },
    {
      "name": "conversation_status",
      "type": "select",
      "options": {
        "values": ["open", "pending", "resolved", "closed"]
      },
      "required": true
    },
    {
      "name": "request_type",
      "type": "select",
      "options": {
        "values": ["initial_contact", "support", "sales", "complaint", "other"]
      },
      "required": true
    },
    {
      "name": "notes",
      "type": "text",
      "required": false
    },
    {
      "name": "assigned_to",
      "type": "text",
      "required": false
    }
  ],
  "listRule": "@request.auth.id != \"\" && (client_id = @request.auth.id || @request.auth.role = \"support\")",
  "viewRule": "@request.auth.id != \"\" && (client_id = @request.auth.id || @request.auth.role = \"support\")",
  "createRule": "@request.auth.id != \"\"",
  "updateRule": "@request.auth.id != \"\" && (client_id = @request.auth.id || @request.auth.role = \"support\")",
  "deleteRule": "@request.auth.id != \"\" && @request.auth.role = \"support\""
} 